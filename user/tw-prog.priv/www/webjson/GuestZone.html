<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW">
  
  <head>
    <title>
      D-LINK
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=9">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Content-Type" content="text/css">
    <link href="css/jquery.selectbox.css" type="text/css" rel="stylesheet"
    />
    <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js">
    </script>
    <script type="text/javascript" charset="utf-8" src="/js/initialJS.js">
    </script>
    <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js">
    </script>
    <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js">
    </script>
    <script>
      $(document).ready(function() {
        presetCheckBox("status_gz_24", true);
        presetCheckBox("status_gz_5", true);
        presetCheckBox("internetAccessOnly", true);
        $("div.checkbox_on" || "div.checkbox_off").click(function(c) {
          var d = c.target.id + "_ck";
          if (c.target.getAttribute("class") == "checkbox_on") {
            var b = I18N("j", "Disabled");
            c.target.setAttribute("class", "checkbox_off");
            c.target.setAttribute("className", "checkbox_off");
            document.getElementById(c.target.id).innerHTML = '<input type="checkbox" name=' + c.target.id + " id=" + d + " checked>" + b;
            document.getElementById(d).checked = false;
            if (d == "status_gz_24_ck") {
              document.getElementById("wifiName_24g").disabled = true;
              document.getElementById("password_24g").disabled = true;
              Show_Table();
              if (Get24GHzHostZoneResult == "false") {
                GetHostZoneEnabled -= 1
              }
            }
            if (d == "status_gz_5_ck") {
              document.getElementById("wifiName_5g").disabled = true;
              document.getElementById("password_5g").disabled = true;
              Show_Table();
              if (Get5GHzHostZoneResult == "false") {
                GetHostZoneEnabled -= 2
              }
            }
            changeFlag = true;
            save_button_changed()
          } else {
            var a = I18N("j", "Enabled");
            c.target.setAttribute("class", "checkbox_on");
            c.target.setAttribute("className", "checkbox_on");
            document.getElementById(c.target.id).innerHTML = '<input type="checkbox" name=' + c.target.id + " id=" + d + ' checked="">' + a;
            document.getElementById(d).checked = true;
            if (d == "status_gz_24_ck") {
              document.getElementById("wifiName_24g").disabled = false;
              document.getElementById("password_24g").disabled = false;
              Show_Table();
              if (Get24GHzHostZoneResult == "false") {
                GetHostZoneEnabled += 1
              }
            }
            if (d == "status_gz_5_ck") {
              document.getElementById("wifiName_5g").disabled = false;
              document.getElementById("password_5g").disabled = false;
              Show_Table();
              if (Get5GHzHostZoneResult == "false") {
                GetHostZoneEnabled += 2
              }
            }
            changeFlag = true;
            save_button_changed()
          }
        })
      });
    </script>
    <script type="text/javascript">
      var HNAP = new HNAP_XML();
      var Get24GHzHostZoneResult = "";
      var Get5GHzHostZoneResult = "";
      var GetHostZoneEnabled = 0;
      var HNAP_WLanRadioSettings;
      var HNAP_WLanRadioSecurity;
      var n24G_SSID, n24G_Mode, n24G_Channel, n24G_TXPower, n24G_ChannelWidth, n24G_Visibility;
      var n5G_SSID, n5G_Mode, n5G_Channel, n5G_TXPower, n5G_ChannelWidth, n5G_Visibility;
      var _ReciprocalNumber = 25;
      function Load_HTML() {
        $("#header").load("header.html")
      }
      function Initial() {
        initialMenu();
        initialDetectRouterConnection()
      }
      function GetXML() {
        HNAP.GetXMLAsync("GetMultipleHNAPs", null, "GetXML",
        function(a) {
          GetResult_1st(a)
        })
      }
      function GetResult_1st(a) {
        if (a != null) {
          a.Set("GetMultipleHNAPs/GetWLanRadioSettings:1/RadioID", "RADIO_2.4G_Guest");
          a.Set("GetMultipleHNAPs/GetWLanRadioSecurity:1/RadioID", "RADIO_2.4G_Guest");
          a.Set("GetMultipleHNAPs/GetWLanRadioSettings:2/RadioID", "RADIO_5G_Guest");
          a.Set("GetMultipleHNAPs/GetWLanRadioSecurity:2/RadioID", "RADIO_5G_Guest");
          a.Set("GetMultipleHNAPs/GetWLanRadioSettings:3/RadioID", "RADIO_2.4GHz");
          a.Set("GetMultipleHNAPs/GetWLanRadioSettings:4/RadioID", "RADIO_5GHz");
          a.Set("GetMultipleHNAPs/GetGuestZoneRouterSettings");
          HNAP.SetXMLAsync("GetWlanGuestSettings", a,
          function(b) {
            GetResult_2nd(b)
          })
        } else {
          if (DebugMode == 1) {
            alert("[!!GetXML Error!!] Function: GetResult_1st")
          }
        }
      }
      function GetResult_2nd(a) {
        var b = a.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");
        if (b == "OK") {
          var h = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse/Enabled");
          if (h == "true") {
            presetCheckBox("status_gz_24", true)
          } else {
            presetCheckBox("status_gz_24", false);
            document.getElementById("wifiName_24g").disabled = true;
            document.getElementById("password_24g").disabled = true;
            Get24GHzHostZoneResult = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/Enabled")
          }
          var f = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:1/SSID");
          document.getElementById("wifiName_24g").value = f;
          var i = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:1/Enabled");
          if (i != "false") {
            var k = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:1/Key");
            document.getElementById("password_24g").value = k
          }
          var j = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:2/Enabled");
          if (j == "true") {
            presetCheckBox("status_gz_5", true)
          } else {
            presetCheckBox("status_gz_5", false);
            document.getElementById("wifiName_5g").disabled = true;
            document.getElementById("password_5g").disabled = true;
            Get5GHzHostZoneResult = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Enabled")
          }
          var e = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:2/SSID");
          document.getElementById("wifiName_5g").value = e;
          var g = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:2/Enabled");
          if (g != "false") {
            var d = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:2/Key");
            document.getElementById("password_5g").value = d
          }
          var c = a.Get("GetMultipleHNAPsResponse/GetGuestZoneRouterSettingsResponse/InternetAccessOnly");
          if (c == "true") {
            presetCheckBox("internetAccessOnly", true);
            document.getElementById("RBZ_Table").style.display = "table-row"
          } else {
            presetCheckBox("internetAccessOnly", false);
            if (document.getElementById("status_gz_24_ck").checked == "1" || document.getElementById("status_gz_5_ck").checked == "1") {
              document.getElementById("RBZ_Table").style.display = "table-row"
            } else {
              document.getElementById("RBZ_Table").style.display = "none"
            }
          }
          n24G_SSID = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/SSID");
          n24G_Mode = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/Mode");
          n24G_Channel = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/Channel");
          n24G_TXPower = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/TXPower");
          n24G_ChannelWidth = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/ChannelWidth");
          n24G_Visibility = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/SSIDBroadcast");
          n5G_SSID = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/SSID");
          n5G_Mode = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Mode");
          n5G_Channel = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Channel");
          n5G_TXPower = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/TXPower");
          n5G_ChannelWidth = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/ChannelWidth");
          n5G_Visibility = a.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/SSIDBroadcast");
          CheckNetworkStatus();
          document.getElementById("main").style.display = "inline"
        } else {
          if (DebugMode == 1) {
            alert("[!!GetXML Error!!] Function: GetResult_2nd")
          }
        }
      }
      function CheckConnectionStatus() {
        $.ajax({
          cache: false,
          url: "./js/CheckConnection",
          timeout: 5000,
          type: "GET",
          success: function(a) {
            SetXML()
          },
          error: function() {
            document.getElementById("DetectRouterConnection").style.display = "inline"
          }
        })
      }
      function SetXML() {
        switch (GetHostZoneEnabled) {
        case 0:
          document.getElementById("CreatePopAlertMessage").style.display = "inline";
          document.getElementById("waitSettingFinish").style.display = "inline";
          HNAP.GetXMLAsync("SetWLanRadioSettings", null, "GetXML",
          function(a) {
            SetResult_1st(a)
          });
          break;
        case 1:
        case 2:
        case 3:
          document.getElementById("CreatePopAlertMessage").style.display = "inline";
          document.getElementById("EnableHostZoneCheck").style.display = "inline";
          break
        }
      }
      function SetResult_1st(c) {
	   var json_SetWLanRadioSettings = {};
        if (GetHostZoneEnabled == 0) {
          if (c != null) {
            HNAP_WLanRadioSettings = c;
           // c.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4G_Guest");
			json_SetWLanRadioSettings["RadioID"] = "RADIO_2.4G_Guest";
            var a = document.getElementById("status_gz_24_ck").checked;
            if (a == "1") {
             // c.Set("SetWLanRadioSettings/Enabled", "true")
			 json_SetWLanRadioSettings["Enabled"] = "true";
            } else {
              //c.Set("SetWLanRadioSettings/Enabled", "false")
			  json_SetWLanRadioSettings["Enabled"] = "false";
            }
           // c.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_24g").value);
          //  c.Set("SetWLanRadioSettings/Mode", n24G_Mode);
          //  c.Set("SetWLanRadioSettings/Channel", n24G_Channel);
          //  c.Set("SetWLanRadioSettings/ChannelWidth", n24G_ChannelWidth);
            //c.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
          //  c.Set("SetWLanRadioSettings/SecondaryChannel", "0");
		  json_SetWLanRadioSettings["SSID"] = document.getElementById("wifiName_24g").value;
		  json_SetWLanRadioSettings["Mode"] = n24G_Mode;
		  json_SetWLanRadioSettings["Channel"] = "n24G_Channel";
		  json_SetWLanRadioSettings["ChannelWidth"] = n24G_ChannelWidth;
		  json_SetWLanRadioSettings["SSIDBroadcast"] = "true";
		  json_SetWLanRadioSettings["SecondaryChannel"] = "0";
		  	
           // HNAP.SetXMLAsync("SetWLanRadioSettings", c, function(e) { SetResult_2nd(e) });
			HNAP.SetJSONAsync("SetWLanRadioSettings", c, json_SetWLanRadioSettings, function(e)	{	SetResult_2nd(e);	});
			}
			else {
            if (DebugMode == 1) {
              alert("[!!SetXML Error!!] Function: SetResult_1st")
            }
          }
        } else {
          if (GetHostZoneEnabled == 1 || GetHostZoneEnabled == 2 || GetHostZoneEnabled == 3) {
            var d = c.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
            if (d == "OK") {
              var b = HNAP_WLanRadioSettings;
            //  b.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4G_Guest");
			  json_SetWLanRadioSettings["RadioID"] = "RADIO_2.4G_Guest";
              var a = document.getElementById("status_gz_24_ck").checked;
              if (a == "1") {
                //b.Set("SetWLanRadioSettings/Enabled", "true")
				 json_SetWLanRadioSettings["Enabled"] = "true";
              } else {

               // b.Set("SetWLanRadioSettings/Enabled", "false")
				json_SetWLanRadioSettings["Enabled"] = "false";
              }
             // b.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_24g").value);
             // b.Set("SetWLanRadioSettings/Mode", n24G_Mode);
             // b.Set("SetWLanRadioSettings/Channel", n24G_Channel);
             // b.Set("SetWLanRadioSettings/ChannelWidth", n24G_ChannelWidth);
             // b.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
             // b.Set("SetWLanRadioSettings/SecondaryChannel", "0");
			  json_SetWLanRadioSettings["SSID"] = document.getElementById("wifiName_24g").value;
			  json_SetWLanRadioSettings["Mode"] = n24G_Mode;
			  json_SetWLanRadioSettings["Channel"] = n24G_Channel;
			  json_SetWLanRadioSettings["ChannelWidth"] = n24G_ChannelWidth;
			  json_SetWLanRadioSettings["SSIDBroadcast"] = "true";
			  json_SetWLanRadioSettings["SecondaryChannel"] = "0";
              //HNAP.SetXMLAsync("SetWLanRadioSettings", b, function(e) { SetResult_2nd(e); });
			  HNAP.SetJSONAsync("SetWLanRadioSettings", b, json_SetWLanRadioSettings, function(e)	{	SetResult_2nd(e);	});
            }
            if (d == "ERROR") {
              if (DebugMode == 1) {
                alert("[!!SetXML Error!!] Function: SetResult_1st")
              }
              window.location.reload()
            }
          } else {
            if (DebugMode == 1) {
              alert("[!!SetXML Error!!] Function: SetResult_1st")
            }
          }
        }
      }
      function SetResult_2nd(b) {
        var a = b.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
        if (a == "OK") {
          HNAP.GetXMLAsync("SetWLanRadioSecurity", null, "GetXML",
          function(c) {
            SetResult_3rd(c)
          })
        }
        if (a == "ERROR") {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_2nd")
          }
          window.location.reload()
        }
      }
      function SetResult_3rd(a) {
        HNAP_WLanRadioSecurity = a;
        if (a != null) {
		var json_SetWLanRadioSecurity = {};
         // a.Set("SetWLanRadioSecurity/RadioID", "RADIO_2.4G_Guest");
		 json_SetWLanRadioSecurity["RadioID"] = "RADIO_2.4G_Guest";
          if (document.getElementById("password_24g").value != "") {
           // a.Set("SetWLanRadioSecurity/Enabled", "true");
           // a.Set("SetWLanRadioSecurity/Type", "WPAORWPA2-PSK");
          //  a.Set("SetWLanRadioSecurity/Encryption", "TKIPORAES");
          //  a.Set("SetWLanRadioSecurity/KeyRenewal", "3600");
          //  a.Set("SetWLanRadioSecurity/Key", document.getElementById("password_24g").value);
			json_SetWLanRadioSecurity["Enabled"] = "true";
			json_SetWLanRadioSecurity["Type"] = "WPAORWPA2-PSK";
			json_SetWLanRadioSecurity["Encryption"] = "TKIPORAES";
			json_SetWLanRadioSecurity["KeyRenewal"] = "3600";
			json_SetWLanRadioSecurity["Key"] = document.getElementById("password_24g").value;
          } else {
            a.Set("SetWLanRadioSecurity/Enabled", "false");
			json_SetWLanRadioSecurity["Enabled"] = "false";
          }
        //  HNAP.SetXMLAsync("SetWLanRadioSecurity", a, function(b) {SetResult_4th(b);});
		 HNAP.SetJSONAsync("SetWLanRadioSecurity", a, json_SetWLanRadioSecurity, function(b)	{	SetResult_4th(b);	});
        } else {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_3rd")
          }
          window.location.reload()
        }
      }
      function SetResult_4th(b) {
        var a = b.Get("SetWLanRadioSecurityResponse/SetWLanRadioSecurityResult");
        if (a == "OK") {
		 var json_SetWLanRadioSettings = {};
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/RadioID", "RADIO_5G_Guest");
		 json_SetWLanRadioSettings["RadioID"] = "RADIO_5G_Guest";
          var c = document.getElementById("status_gz_5_ck").checked;
          if (c == "1") {
          //  HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "true");
			 json_SetWLanRadioSettings["Enabled"] = "true";
          } else {
            //HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "false");
			json_SetWLanRadioSettings["Enabled"] = "false";
          }
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_5g").value);
		 json_SetWLanRadioSettings["SSID"] = document.getElementById("wifiName_5g").value;
          if (IsSupport11ac_5GHz != "1") {
           // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11an");
		   json_SetWLanRadioSettings["Mode"] = "802.11an";
          } else {
            //HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11anac")
			json_SetWLanRadioSettings["Mode"] = "802.11anac";
          }
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Channel", n5G_Channel);
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
         // HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SecondaryChannel", "0");
		 json_SetWLanRadioSettings["Channel"] = n5G_Channel;
		 json_SetWLanRadioSettings["ChannelWidth"] = n5G_ChannelWidth;
		 json_SetWLanRadioSettings["SSIDBroadcast"] = "false";
		 json_SetWLanRadioSettings["SecondaryChannel"] = "0";
         // HNAP.SetXMLAsync("SetWLanRadioSettings", HNAP_WLanRadioSettings, function(d) { SetResult_5th(d);});
		  HNAP.SetJSONAsync("SetWLanRadioSettings", HNAP_WLanRadioSettings, json_SetWLanRadioSettings, function(d)	{	SetResult_5th(d);	});
        }
        if (a == "ERROR") {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_4th")
          }
          window.location.reload()
        }
      }
      function SetResult_5th(a) {
        var b = a.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
        if (b == "OK") {
		 var json_SetWLanRadioSecurity = {};
          var c = HNAP_WLanRadioSecurity;
         // c.Set("SetWLanRadioSecurity/RadioID", "RADIO_5G_Guest");
		  json_SetWLanRadioSecurity["RadioID"] = "RADIO_5G_Guest";
          if (document.getElementById("password_5g").value != "") {
          //  c.Set("SetWLanRadioSecurity/Enabled", "true");
          //  c.Set("SetWLanRadioSecurity/Type", "WPAORWPA2-PSK");
          //  c.Set("SetWLanRadioSecurity/Encryption", "TKIPORAES");
          //  c.Set("SetWLanRadioSecurity/KeyRenewal", "3600");
         //   c.Set("SetWLanRadioSecurity/Key", document.getElementById("password_5g").value);
		 	json_SetWLanRadioSecurity["Enabled"] = "true";
			json_SetWLanRadioSecurity["Type"] = "WPAORWPA2-PSK";
			json_SetWLanRadioSecurity["Encryption"] = "TKIPORAES";
			json_SetWLanRadioSecurity["KeyRenewal"] = "3600";
			json_SetWLanRadioSecurity["Key"] = document.getElementById("password_5g").value;
		 
          } else {
           // c.Set("SetWLanRadioSecurity/Enabled", "false");
		   json_SetWLanRadioSecurity["Enabled"] = "false";
          }
         // HNAP.SetXMLAsync("SetWLanRadioSecurity", c, function(d) { SetResult_6th(d); });
		  HNAP.SetJSONAsync("SetWLanRadioSecurity", c, json_SetWLanRadioSecurity, function(d)	{	SetResult_6th(d);	});
        }
        if (b == "ERROR") {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_5th")
          }
          window.location.reload()
        }
      }
      function SetResult_6th(b) {
        var a = b.Get("SetWLanRadioSecurityResponse/SetWLanRadioSecurityResult");
        if (a == "OK") {
          HNAP.GetXMLAsync("SetGuestZoneRouterSettings", null, "GetXML",
          function(c) {
            SetResult_7th(c)
          })
        }
        if (a == "ERROR") {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_6th")
          }
          window.location.reload()
        }
      }
      function SetResult_7th(a) {
        if (a != null) {
			var json_SetGuestZoneRouterSettings = {};
          if (document.getElementById("internetAccessOnly_ck").checked == "1") {
		    json_SetGuestZoneRouterSettings["InternetAccessOnly"] = "true";
			 json_SetGuestZoneRouterSettings["DHCPServer"] = "true";
           // a.Set("SetGuestZoneRouterSettings/InternetAccessOnly", "true");
           // a.Set("SetGuestZoneRouterSettings/DHCPServer", "true")
          } else {
           // a.Set("SetGuestZoneRouterSettings/InternetAccessOnly", "false");
           // a.Set("SetGuestZoneRouterSettings/DHCPServer", "false");
			 json_SetGuestZoneRouterSettings["InternetAccessOnly"] = "false";
			 json_SetGuestZoneRouterSettings["DHCPServer"] = "false";
          }
         // HNAP.SetXMLAsync("SetGuestZoneRouterSettings", a, function(b) { SetResult_8th(b); });
		 HNAP.SetJSONAsync("SetGuestZoneRouterSettings", a, json_SetGuestZoneRouterSettings, function(b)	{	SetResult_8th(b);	});
        } else {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_7th")
          }
          window.location.reload()
        }
      }
      function SetResult_8th(a) {
        var b = a.Get("SetGuestZoneRouterSettingsResponse/SetGuestZoneRouterSettingsResult");
        if (b == "OK") {
          document.getElementById("result_Message").innerHTML = I18N("j", "Your changes are being saved. When reconnecting to this device, please use the new Wi-Fi name and password you created.");
          Start_reciprocal_Number_RestoreConfiguration()
        }
        if (b == "ERROR") {
          if (DebugMode == 1) {
            alert("[!!SetXML Error!!] Function: SetResult_8th")
          }
          window.location.reload()
        }
      }
      function Show_Table() {
        if (document.getElementById("status_gz_24_ck").checked == "1" || document.getElementById("status_gz_5_ck").checked == "1") {
          document.getElementById("RBZ_Table").style.display = "table-row"
        } else {
          document.getElementById("RBZ_Table").style.display = "none"
        }
      }
      function returnToMain() {
        document.getElementById("CreatePopAlertMessage").style.display = "none";
        document.getElementById("EnableHostZoneCheck").style.display = "none"
      }
      function SetupHostZone() {
        document.getElementById("CreatePopAlertMessage").style.display = "inline";
        document.getElementById("EnableHostZoneCheck").style.display = "none";
        document.getElementById("waitSettingFinish").style.display = "inline";
        HNAP.GetXMLAsync("SetWLanRadioSettings", null, "GetXML",
        function(a) {
          SetResult_9th(a)
        })
      }
      function SetResult_9th(a) {
        HNAP_WLanRadioSettings = a;
		var json_SetWLanRadioSettings = {};
        if (a != null) {
          if (GetHostZoneEnabled == 1 || GetHostZoneEnabled == 3) {
           // a.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4GHz");
           // a.Set("SetWLanRadioSettings/Enabled", "true");
           // a.Set("SetWLanRadioSettings/SSID", n24G_SSID);
          //  a.Set("SetWLanRadioSettings/Mode", n24G_Mode);
          //  a.Set("SetWLanRadioSettings/Channel", n24G_Channel);
          //  a.Set("SetWLanRadioSettings/TXPower", n24G_TXPower);
          //  a.Set("SetWLanRadioSettings/ChannelWidth", n24G_ChannelWidth);
          //  a.Set("SetWLanRadioSettings/SSIDBroadcast", n24G_Visibility);
		  json_SetWLanRadioSettings["RadioID"] = "RADIO_2";
		  json_SetWLanRadioSettings["Enabled"] = "true";
		  json_SetWLanRadioSettings["SSID"] = n24G_SSID;
		  json_SetWLanRadioSettings["Mode"] = n24G_Mode;
		  json_SetWLanRadioSettings["Channel"] = n24G_Channel;
		  json_SetWLanRadioSettings["TXPower"] = n24G_TXPower;
		  json_SetWLanRadioSettings["ChannelWidth"] = n24G_ChannelWidth;
		  json_SetWLanRadioSettings["SSIDBroadcast"] = n24G_Visibility;
		  
            if (GetHostZoneEnabled == 1) {
             // HNAP.SetXMLAsync("SetWLanRadioSettings", a,function(b) { SetResult_1st(b); });
			   HNAP.SetJSONAsync("SetWLanRadioSettings", a, json_SetWLanRadioSettings, function(b)	{	SetResult_1st(b);	});
            } else {
             // HNAP.SetXMLAsync("SetWLanRadioSettings", a,function(b) { SetResult_10th(b);});
			  HNAP.SetJSONAsync("SetWLanRadioSettings", a, json_SetWLanRadioSettings, function(b)	{	SetResult_10th(b);	});
            }
          } else {
            if (GetHostZoneEnabled == 2) {
             // a.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz");
            //  a.Set("SetWLanRadioSettings/Enabled", "true");
            //  a.Set("SetWLanRadioSettings/SSID", n5G_SSID);
            //  a.Set("SetWLanRadioSettings/Mode", n5G_Mode);
            //  a.Set("SetWLanRadioSettings/Channel", n5G_Channel);
            //  a.Set("SetWLanRadioSettings/TXPower", n5G_TXPower);
            //  a.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
            //  a.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility);
			  json_SetWLanRadioSettings["RadioID"] = "RADIO_5GHz";
			  json_SetWLanRadioSettings["Enabled"] = "true";
			  json_SetWLanRadioSettings["SSID"] = n5G_SSID;
			  json_SetWLanRadioSettings["Mode"] = n5G_Mode;
			  json_SetWLanRadioSettings["Channel"] = n5G_Channel;
			  json_SetWLanRadioSettings["TXPower"] = n5G_TXPower;
			  json_SetWLanRadioSettings["ChannelWidth"] = n5G_ChannelWidth;
			  json_SetWLanRadioSettings["SSIDBroadcast"] = n5G_Visibility;
             // HNAP.SetXMLAsync("SetWLanRadioSettings", a, function(b) { SetResult_1st(b);});
			  HNAP.SetJSONAsync("SetWLanRadioSettings", a, json_SetWLanRadioSettings, function(b)	{	SetResult_1st(b);	});
            } else {
              alert("An error occurred!");
              window.location.reload()
            }
          }
        }
      }
      function SetResult_10th(a) {
        var b = HNAP_WLanRadioSettings;
        var c = a.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
        if (c == "OK") {
		var json_SetWLanRadioSettings = {};
         // b.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz");
        //  b.Set("SetWLanRadioSettings/Enabled", "true");
         // b.Set("SetWLanRadioSettings/SSID", n5G_SSID);
        //  b.Set("SetWLanRadioSettings/Mode", n5G_Mode);
        //  b.Set("SetWLanRadioSettings/Channel", n5G_Channel);
        //  b.Set("SetWLanRadioSettings/TXPower", n5G_TXPower);
        //  b.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
       //   b.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility);
		  json_SetWLanRadioSettings["RadioID"] = "RADIO_5GHz";
		  json_SetWLanRadioSettings["Enabled"] = "true";
		  json_SetWLanRadioSettings["SSID"] = n5G_SSID;
		  json_SetWLanRadioSettings["Mode"] = n5G_Mode;
		  json_SetWLanRadioSettings["Channel"] = n5G_Channel;
		  json_SetWLanRadioSettings["TXPower"] = n5G_TXPower;
		  json_SetWLanRadioSettings["ChannelWidth"] = n5G_ChannelWidth;
		  json_SetWLanRadioSettings["SSIDBroadcast"] = n5G_Visibility; 
		  //HNAP.SetXMLAsync("SetWLanRadioSettings", b, function(d) {  SetResult_1st(d)  })
		  HNAP.SetJSONAsync("SetWLanRadioSettings", b, json_SetWLanRadioSettings, function(d)	{	SetResult_1st(d);	});
        }
        if (c == "ERROR") {
          alert("An error occurred!");
          window.location.reload()
        }
      }
      function Start_reciprocal_Number_RestoreConfiguration() {
        if (_ReciprocalNumber >= 0) {
          document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
          _ReciprocalNumber--;
          setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000)
        } else {
          window.location.reload()
        }
      }
      function CheckNetworkStatus() {
        var a = sessionStorage.getItem("networkStatus");
        if ((a == 1) && (currentDevice.helpVer != "")) {
          document.getElementById("Get_Help").style.display = "inline"
        } else {
          document.getElementById("Get_Help").style.display = "none"
        }
      };
    </script>
    <script language="JavaScript">
      $(function() {
        $("select").change(function() {
          save_button_changed()
        });
        $("input").keydown(function() {
          save_button_changed()
        })
      });
      function save_button_changed() {
        document.getElementById("Save_Disable_btn").style.display = "none";
        document.getElementById("Save_btn").style.display = "block";
        changeFlag = true;
        checkFlag = true;
        GetClickTime()
      };
    </script>
  </head>
  
  <body>
    <form name="wifi_guest_form" id="wifi_guest_form" method="POST" action="">
      <div id="wrapper">
        <div id="header">
        </div>
        <div id="menu">
        </div>
        <div id="menu_edge">
        </div>
        <div id="content">
          <div id="info">
            <div id="FunctionName">
              <script>
                I18N("h", "Guest Zone");
              </script>
            </div>
            <div id="wallimage">
              <img src="image/Guest.png" alt="" width="195" height="119" />
            </div>
            <div id="directions">
              <script>
                I18N("h", "This page lets you configure a Wi-Fi Guest Zone. Wi-Fi Guest Zones are Wi-Fi networks that are separate from your normal ones, and use different Wi-Fi Network Names and passwords. Users connected to a Guest Zone cannot communicate or detect devices on your normal network unless the Routing Between Zones option is enabled. Guest Zones are useful to give guests Internet access without allowing them to access your own devices on your network.");
              </script>
              <label id="Get_Help" onClick="showOnlineHelp('Guest Zone');" style="cursor:pointer;display:none;text-Decoration:underline">
                <script>
                  I18N("h", "Click here for help.");
                </script>
              </label>
            </div>
          </div>
          <div id="funcBar">
            <div id="pagePath">
              <script>
                I18N("h", "Settings");
              </script>
              >>
              <script>
                I18N("h", "Wireless(Wi-Fi)");
              </script>
              >>
              <script>
                I18N("h", "Guest Zone");
              </script>
            </div>
            <ul id="rightFunc">
              <li style="display:block">
                <div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()"
                style="cursor:pointer; display:none">
                  <script>
                    I18N("h", "Save");
                  </script>
                </div>
              </li>
              <li style="display:block">
                <div id="Save_Disable_btn">
                  <script>
                    I18N("h", "Save");
                  </script>
                </div>
              </li>
              <input id="sumbit_CheckData" class="submit" type="submit" value="Submit"
              style="display:none" />
              <li style="display:block">
                <a href="javascript:CheckHTMLStatus('WiFi');" style="text-decoration:none;"
                onclick="return confirmExit()">
                  <div id="page_btn" class="linkstyle_1">
                    <script>
                      I18N("h", "Wi-Fi");
                    </script>
                  </div>
                </a>
              </li>
            </ul>
          </div>
          <div id="main" style="display:none">
            <table class="block" style="margin: 10px 0 0 0;">
              <tbody>
                <tr>
                  <td>
                    <div class="title">
                      2.4GHz
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Status");
                    </script>
                    :
                  </th>
                  <td>
                    <div id="status_gz_24" class="checkbox_on">
                      <input type="checkbox" name="status_gz_24" id="status_gz_24_ck" checked>
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Wi-Fi Name (SSID)");
                    </script>
                    :
                  </th>
                  <td>
                    <input class="styled-text" type="text" name="wifiName_24g" size="30" id="wifiName_24g"
                    maxlength="32">
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Password");
                    </script>
                    :
                  </th>
                  <td>
                    <input class="styled-text" type="text" name="password_24g" size="30" id="password_24g"
                    maxlength="63">
                  </td>
                </tr>
              </tbody>
            </table>
            <hr/>
            <table class="block" style="margin: 10px 0 0 0;">
              <tbody>
                <tr>
                  <td>
                    <div class="title">
                      5GHz
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Status");
                    </script>
                    :
                  </th>
                  <td>
                    <div id="status_gz_5" class="checkbox_on">
                      <input type="checkbox" name="status_gz_5" id="status_gz_5_ck" checked>
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Wi-Fi Name (SSID)");
                    </script>
                    :
                  </th>
                  <td>
                    <input class="styled-text" type="text" name="wifiName_5g" size="30" id="wifiName_5g"
                    maxlength="32">
                    </input>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Password");
                    </script>
                    :
                  </th>
                  <td>
                    <input class="styled-text" type="text" name="password_5g" size="30" id="password_5g"
                    maxlength="63">
                  </td>
                </tr>
              </tbody>
            </table>
            <hr/>
            <table class="block" id="RBZ_Table" style="margin: 10px 0 0 0;display:none">
              <tbody>
                <tr>
                  <td>
                    <div class="title">
                      <script>
                        I18N("h", "Home Network Access");
                      </script>
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>
                    <script>
                      I18N("h", "Internet Access Only");
                    </script>
                    :
                  </th>
                  <td>
                    <div id="internetAccessOnly" class="checkbox_on">
                      <input type="checkbox" name="internetAccessOnly" id="internetAccessOnly_ck"
                      checked>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div id="CreatePopAlertMessage" style="display:none">
            <div id="AlertPopRect">
              <div id="AlertPopBody">
                <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"
                style="display:none">
                  <tbody>
                    <tr>
                      <td>
                        <center>
                          <div id="Loading_pop_image">
                          </div>
                        </center>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <label id="reciprocal_Number">
                        </label>
                      </td>
                    </tr>
                    <tr>
                      <td id="dialog_msg_black">
                        <label id="result_Message">
                          <script>
                            I18N("h", "Your changes are being saved.");
                          </script>
                        </label>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <table class="myAlertPop_table_b" id="EnableHostZoneCheck" border="0"
                cellspacing="0" style="display:none">
                  <tbody>
                    <tr>
                      <td colspan="2">
                        <center>
                          <div id="Information_pop_image">
                          </div>
                        </center>
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">
                        <center>
                          <div id="dialog_msg_black">
                            <script>
                              I18N("h", "Your Wi-Fi network needs to be enabled in order to turn on Guest Zone network. Would you like to turn on both?");
                            </script>
                          </div>
                          <center>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div id="Confirm_btn" onclick="SetupHostZone()" style="cursor:pointer">
                          <script>
                            I18N("h", "OK");
                          </script>
                        </div>
                      </td>
                      <td>
                        <div id="Confirm_btn" onclick="returnToMain()" style="cursor:pointer">
                          <script>
                            I18N("h", "Cancel");
                          </script>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div id="DetectRouterConnection" style="display:none">
        </div>
        <div id="footer">
          <div id="copyright">
            <script>
              I18N("h", "COPYRIGHT");
            </script>
          </div>
        </div>
      </div>
    </form>
    <script type="text/javascript" charset="utf-8">
      $(document).ready(function() {
        var a = "";
        $.validator.setDefaults({
          submitHandler: function(b) {
            b.submit()
          }
        });
        $.validator.addMethod("checkWPAPassword",
        function(d, b) {
          var c = true;
          if (d.length != 0) {
            if (d.length > 63 || d.length < 8) {
              c = false
            }
          } else {
            c = true
          }
          return c
        },
        jQuery.validator.messages.password_WPACheck);
        $.validator.addMethod("checkssid",
        function(d, b) {
          var c = true;
          if (d == "") {
            c = false
          } else {
            c = true
          }
          return c
        },
        jQuery.validator.messages.ssid);
        $("#wifi_guest_form").validate({
          rules: {
            wifiName_24g: {
              checkssid: true
            },
            password_24g: {
              checkWPAPassword: true
            },
            wifiName_5g: {
              checkssid: true
            },
            password_5g: {
              checkWPAPassword: true
            }
          },
          submitHandler: function(b) {
            CheckConnectionStatus()
          }
        })
      });
    </script>
  </body>
  <script type="text/javascript">
    Load_HTML();
    Initial();
    setMenu("menu_Settings");
    GetXML();
    checkTimeout();
  </script>

</html>